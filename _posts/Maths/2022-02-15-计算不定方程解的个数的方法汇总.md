---
categories: [Maths]
tags: Combinatorics
---

# 写在前面

最近做了一些题目, 才发现当初学习组合数学时候还是做的题太少, 很多东西只是知道其概念如何, 真正上手题目还是 get 不到精髓. 这次来总结一下`计算不定方程解的个数的一些方法`, 加深一下对这块知识点的掌握.

# 问题

求解不定方程中解的个数, 这里面的不定方程指的是形如下面的方程:

$$
x_1+x_2+\cdots+x_n=k, \quad x_i\in \mathbb{Z},(i=1,2,\cdots, n).
$$

对于这样的方程, 其组合意义很容易与球盒模型进行对应, 即将$k$个相同的球放入$n$个不同的盒子的方法数(注意到$x_i$可以取负数, 所以球盒模型只能解释$x_i$为非负整数的情形).

我们要求上述方程中解的个数, 一个直观的思路是通过枚举来计算, 但是这不是一个一般的方法, 下面通过介绍一些简单的组合学知识来进一步分析计算不定方程解的个数.

# 知识点回顾

这里需要先来看看关于组合中 `重集的组合`,`容斥原理`的知识, 其中容斥原理是方便计算不定元范围有上界的情形.

## 重集的组合

$$
\begin{aligned}
    N&=\{k_1a_1,k_2a_2,\cdots,k_na_n\}, &(有重数限制)\\
    M&=\{\infty\cdot a_1,\infty\cdot a_2,\cdots,\infty\cdot a_n\}, &(无重数限制)\\
\end{aligned}
$$

定义: 重集$M$的一个$k-$组合$B$, 就是一个$M[k]$到$\{a_1,a_2,\cdots,a_n\}$的映射$B$.

几种等价形式:

1. $\varphi:\{a_1,a_2,\cdots,a_n\}\to\{0,1,2,\cdots\}$, 且$\sum_{i=1}^n\varphi(a_i)=k$.这样的映射全体与$M$ 的$k-$组合一一对应.
2. 不定方程$x_1+x_2+\cdots+x_n=k$其中$x_i$为非负整数. 方程的解集合与重集$M$的$k-$组合一一对应.
3. **球盒模型**, $k$个相同的球放入$n$个不同的盒子的不同放法数.

定理: 重集的$k-$组合数为

$$
\left\langle\begin{matrix}n\\k
\end{matrix}\right\rangle=\frac{\langle n\rangle_k}{k!}=\binom{n+k-1}{k}.
$$

> 证明: (方法一: 用递推关系证明)
>
> 设$T(n,k)$表示不定方程$x_1+x_2+\cdots+x_n=k$的非负整数解的个数, 则方程的解可分为两种形式:
>
> 1.  $x_1=0$, 即$x_2+x_3+\cdots+x_n=k$的非负整数解, 共有$T(n-1,k)$个;
> 2.  $x_1\geqslant1$, 令$x_1'=x_1-1\geqslant0$, 方程的解等价于$x_1'+x_2+\cdots+x_n=k-1$的非负整数解, 共有$T(n, k-1)$个;
>
> 于是有$T(n,k)=T(n-1,k)+T(n, k-1)$.
>
> 又有初始值$T(n,0)=1, T(1, k)=1$(可以通过生成函数来求出$T(n,k)$
>
> 而
>
> $$
> \left\langle\begin{matrix}n\\ k
> \end{matrix}\right\rangle=\binom{n+k-1}{k},
> $$
>
> 也满足上述递推关系以及初值, 所以:
>
> $$
> \Rightarrow T(n,k)=\binom{n-k+1}k.
> $$

---

> 方法二: 从**球盒模型组合意义**出发证明, $k$个相同的球放入$n$个不同的盒子中.
>
> $n$个盒子并排放, 共有$n-1$条公共边.
>
> $n-1$条公共边和$k$个球共占用$n+k-1$个位置.
>
> 每一种放法对应于从$n+k-1$个位置中选$n-1$个位置作为盒子的公共边.
>
> 于是共有$\binom{n+k-1}{n-1}=\binom{n+k-1}k$种方法.

---

> 方法三:(用隔板法证明)
>
> $k$个相同的球放入$n$个不同的盒子, 且每个盒子至少 1 个球(隔板问题)
>
> 即从$k$个球中间的$k-1$个位置选择$n-1$位置放置隔板,共有$\binom{k-1}{n-1}$种, 对应不定方程$x_1+x_2+\cdots+x_n=k$的**正整数解**的个数.
>
> 而所求为$x_1+x_2+\cdots+x_n=k$的非负整数解的个数, 转化为正整数解,等价于
>
> $$
>   x_1'+x_2'+\cdots+x_n'=k+n\quad(x_i'=x_i+1)
> $$
>
> 的正整数解的个数:$\binom{n+k-1}{n-1}={n+k-1\choose k}$.

## 容斥原理

**定理(包含排除原理)**

设$S$为一个有限集, $P_i(1\le i\le m)$为$m$个性质,

- $$
  A_i=\{x|x\in S, x具有性质P_i\}
  $$

- $$
  \bar A_i=\{x|x\in S, x不具有性质P_i\}
  $$

---

- $$
  \bar A_1\cap\bar A_2\cap\cdots\cap\bar A_m=\{x|x\in S, 且x不具有P_i中任何性质\}
  $$

- $$
  A_1\cup A_2\cup\cdots\cup A_m=\{x|x\in S, 且x具有全部性质\}
  $$

$S$中**不具有任何性质**的元素个数为:

$$
\begin{aligned}
&|\bar A_1\cap\bar A_2\cap\cdots\cap\bar A_n|\\[5pt]
=|S|&-\sum_{1\leqslant i\leqslant m}|A_i|+\sum_{1\leqslant i<j\leqslant m}|A_i\cap A_j|\\
&-\sum_{1\leqslant i<j<k\leqslant m}|A_i\cap A_j\cap A_k|+\cdots\\
&+(-1)^m|A_1\cap A_2\cap\cdots\cap A_m|.
\end{aligned}
$$

> 证明:
>
> 要证明定理成立, 只需证明$S$中任意元素在等式两边被计算的次数相等.
>
> 1.  $x$不具有任何性质$(x\notin S)$, 则$1=1-0+0\cdots+(-1)^m0$,成立;
>
> 2.  $y$具有$t$个性质, $1\le t\le m$, $y\in S$, 则
>     $$
>     0=1-\binom t1+\binom t2-\binom t3+\cdots+(-1)^t\binom tt=(1-1)^t,
>     $$
>     显然成立. 证完.

# 不定元有下界的整数解个数

这类问题比较简单, 上面的重集组合部分已经讨论了, 直接代入公式就可以计算, 下面以一个例题来进行讲解.

$x_1+x_2+x_3+x_4=9$,其中

$$
\begin{cases}x_1\geq 1,\\x_2\geq 2,\\x_3\geq 1,\\x_4\geq 3,\end{cases}
$$

的整数解的个数.

> 令$y_1=x_1-1$, $y_2=x_2-2$, $y_3=x_3-1$, $y_4=x_4-3$.
>
> 则上述方程等价于$y_1+y_2+y_3+y_4=9-7=2$的非负整数解的个数.
>
> 由重集$M$的$k-$组合数$\Rightarrow {4+2-1\choose 2}={5\choose2}=10$.

# 不定元任意范围的整数解个数

求不定方程

$$
x_1+x_2+x_3=9,\quad 1\le x_1\le3,2\le x_2\le 4,0\le x_3\le5,
$$

的整数解的个数.

> 解: 令$y_1=x_1-1,y_2=x_2-2,y_3=x_3$, 原不定方程可以等价于求解
>
> $$
> y_1+y_2+y_3=6,\quad 0\le y_1\le2,0\le y_2\le 2,0\le y_3\le5,
> $$
>
> 的整数解的个数, 令$S$为方程$y_1+y_2+y_3=6$的非负整数解, 则
>
> $$
> |S|=\binom{3+6-1}{6}=\binom86=28.
> $$
>
> 令$P_1$为性质$y_1\ge 3$, $P_2$为性质$y_2\ge3$, $P_3$为性质$y_3\ge6$, $A_i$表示满足性质$P_i$的解构成 的集合$i=1,2,3$,
>
> $$
> |\bar A_1\cap\bar A_2\cap\bar A_3|=28-\binom{3+3-1}3*2-1+1+0*2-0=8.
> $$

当然, 如果不用容斥原理, 也可以通过生成函数的方法进行计算, 下面具体说说.

> 直接设不定方程
>
> $$
> x_1+x_2+x_3=k,
> $$
>
> 整数解个数为$a_k$, 则容易得到$a_k$的生成函数为:
>
> $$
> \begin{aligned}
> g(x)
> &=(x+x^2+x^3)(x^2+x^3+x^4)(1+x+\cdots+x^5)\\
> &=x^3(1+x+x^2)^2(1+x+\cdots+x^5)\\
> &=x^{12}+3 x^{11}+6 x^{10}+8 x^9+9 x^8+9 x^7+8 x^6+6 x^5+3 x^4+x^3
> \end{aligned}
> $$
>
> 于是直接得到$a_9=8$.
